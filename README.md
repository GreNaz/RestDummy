Что умеет заглушка?

- Добавлять шаблоны ответа через гуи
- Менять времена отклика через гуи и по rest запросу
- Останавливать сервис через гуи и по rest запросу
- Выставлять шедулер для долгого отклика и отключения сервиса
- -10% от таймаута по всем сервисам
- Выключить и включить все сервисы


С чего начать?

Необходимо собрать jar, закинуть на сервер jar + файл properties.
В файле изменить порт на свой и добавить имя подсистемы в файле properties по примеру:
server.port=65376
subsystem=VASHA_SUBSYSTEM
influxdb.chanel=SBOL

Добавить новый сервис:

1- Кнопка "Добавить сервис". Ребут заглушки не требуется.

2- Руками. Добавить файл без расширения - имя файла - ваш эндпоинт. Требуется ребут заглушки.

ВАЖНО:
- По кнопке - необходимо добавить имя сервиса(файл и эндпоинт) и тело файла.

- Имя сервиса - имя вашего эндпоинта. Чувствителен к регистру. (Если необходим особенный эндпоинт со слешами см. раздел Дополнительно)

- Если вам нужно коррелировать параметры, необходимо добавить на место значения имя параметра заключенного в "__".
Пример: "rqUid": "__rqUid__"
Обращайте внимание на имя параметров - РЕГИСТР ДОЛЖЕН СООТВЕТСТВОВАТЬ ПОЛЮ/TЭГУ.

- Поддерживаемые типы файлов: xml, json.

- Тело файла должно включать обязательный для заполнения раздел:
---
delay=1000;
timeout=3000;
type=json;
---

Для корректной работы необходимо заключить текст в "---". И закрывать каждый параметр ";".


Пример файла:
{
"rqUid": "__rqUid__",
"rqTm": "__rqTm__",
"operUid": "ccc147cfbbe14934a2b470bb0afa20f4",
"spName": "urn: sbrfsystems: 99-ufs",
"systemId": "urn: sbrfsystems: 99-pprb",
"status": {
"statusCode": 0,
"statusDesc": "Успешно создан драфт договора. "
}
}
---
delay=1000;
timeout=3000;
type=json;
---


Дополнительно:

Несколько ответов от сервиса по процентной разбивке: Вам необходимо в файл добавить все ответы и заключить КАЖДЫЙ в -###-. Т.е между каждым верхним и кажним будет стоять два таких обозначения -###--###- 

Если вам необходим эндпоинт типа /set/preset/VashService (особенные случаи)
в тело файла необходимо добавить четвертый параметр: endpoint=/set/preset/VashService;

В таком случае имя файла у вас останется обычным VashService. Но когда контекст заглушки будет подниматься - за имя сервиса и эндпоинта будет считать ваш параметр.

В таком случае вызов супа будет http://host:port/customEndpoint, где после на беке будет подставляется http://host:port/customEndpoint/set/preset/VashService

Сервис удаляется руками на сервере
Обновить сервис можно по кнопке в гуи - указав то же название и заменив полностью тело файла


СУП. Как настраивать ФП на заглушку:
В супе параметр должен выглядеть так:http://host:port/services?service=VashService

Т.е. ваш эндпоинт передается в качестве параметра service=VashService

Шедулер:
Кнопка "Изменить".
Выставить время начала задержки или/и отключения.
Задержка дефолтная 10 минут.

Для использования в иных автоматизациях:
Чтобы выставить delay рестом: http://host:port/services?service=VashService&delay=1000

Чтобы остановить/включить сервис рестом: http://host:port/services?service=VashService&isAvailable=false



Настройка логирования:
Если вам очень сильно нужно посмотреть что приходит/уходит вы можете включить логирование в файле properties.
logging.level.root=info
После того как закончите, ПОЖАЛУЙСТА, верните логирование обратно в error. При обычной работе не должно писаться много логов.

Логи запроса можно найти по слову REQUEST:

Логи ответа можно найти по слову RESPONSE: